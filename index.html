<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TV Digital en Vivo</title>
  <link rel="stylesheet" href="stile.css" />
  <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/833/833472.png" />
  <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

</head>

<body>
  <!-- Botón para instalar la app (invisible por defecto) -->
<button id="btn-instalar" style="display: none;">Instalar Aplicación</button>

<!-- Código para gestionar la instalación -->
<script>
  let deferredPrompt;

  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    document.getElementById('btn-instalar').style.display = 'block';

    document.getElementById('btn-instalar').addEventListener('click', () => {
      document.getElementById('btn-instalar').style.display = 'none';
      deferredPrompt.prompt();
      deferredPrompt.userChoice.then((choiceResult) => {
        if (choiceResult.outcome === 'accepted') {
          console.log('Usuario aceptó la instalación');
        } else {
          console.log('Usuario canceló la instalación');
        }
        deferredPrompt = null;
      });
    });
  });
</script>
<!-- Registro del service worker -->
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('service-worker.js')
      .then(reg => console.log('Service Worker registrado'))
      .catch(err => console.error('Error al registrar Service Worker', err));
  }
</script>

  <header>
    <h1>TV Digital en Vivo</h1>
    <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

  </header>

  <main>
    <!-- Reproductor de video -->
    <section class="player-section">
      <h2 id="nombre-canal">Selecciona un canal</h2>
      <div class="video-container">
        <div class="overlay">
          <div class="logo-overlay" aria-label="Logo TV Digital en Vivo" role="img">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" fill="white" width="50" height="50">
              <path d="M592 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h224v32H160c-8.8 0-16 7.2-16 16s7.2 16 16 16h320c8.8 0 16-7.2 16-16s-7.2-16-16-16H368v-32h224c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zM192 304V96l192 104-192 104z"/>
            </svg>
          </div>
          <div id="hora-overlay" class="hora-overlay"></div>
        </div>
        <video id="videoPlayer" controls autoplay playsinline></video>
      </div>
      <div class="controls">
        <button onclick="fullscreen()">Pantalla Completa</button>
        <button onclick="activarPiP()">Ventana Flotante</button>
      </div>
    </section>

    <!-- Tarjetas de canales -->
    <section class="canales-grid">
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/utv/chunks.m3u8', 'UTV',this)">
        <img src="/img/utv.png" alt="UTV" />
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/americatv/bitel/americatv_ori_480p/chunks.m3u8', 'AMÉRICA TV',this)">
        <img src="/img/america.png" alt="AMERICA" />
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/panamericana/bitel/panamericana_ori_480p/chunks.m3u8', 'PANAMERICANA TV',this)">
        <img src="/img/PANAMERICANA.png" alt="PANAMERICANA" />
        </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/latina/bitel/latina_ori_480p/chunks.m3u8', 'LATINA',this)">
        <img src="/img/LATINA.png" alt="LATINA" />
        </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/atv/bitel/atv_ori_480p/chunks.m3u8', 'ATV',this)">
        <img src="/img/ATV.png" alt="ATV" />
        </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/fmhmovies/chunks.m3u8', 'FMH MOVIES',this)">
        <img src="/img/FMH MOVIES.png" alt="FMH MOVIES">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/fmhkids/chunks.m3u8', 'FMH KIDS',this)">
        <img src="/img/FMH KIDS.png" alt="FMH KIDS">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/bnb/chunks.m3u8', 'BNB',this)">
        <img src="/img/BNB.png" alt="BNB">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/ribere%C3%B1a/chunks.m3u8', 'RIBEREÑA',this)">
        <img src="/img/RIBEREÑA.jpg" alt="RIBEREÑA">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/ucayalitv/chunks.m3u8', 'UCAYALI TV',this)">
        <img src="/img/UCAYALI TV.jpg" alt="UCAYALI TV">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/creolatino/chunks.m3u8', 'CREO LATINO',this)">
        <img src="/img/CREO LATINO.png" alt="CREO LATINO TU CINE">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/creokids/chunks.m3u8', 'CREO LATINO KIDS,this')">
        <img src="/img/CREO KIDS.png" alt="CREO KIDS">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/global/bitel/global_ori_480p/chunks.m3u8', 'GLOBAL TV',this)">
        <img src="/img/GLOBAL.png" alt="GLOBAL TV">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/animeOnegai/bitel/animeOnegai_ori_360p/chunks.m3u8', 'ANIME ONEGAI',this)">
        <img src="/img/ANIME ONEGAI.png" alt="ANIME ONEGAI">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/nativa/bitel/nativa_ori_480p/chunks.m3u8', 'NATIVA',this)">
        <img src="/img/NATIVA.png" alt="NATIVA">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/tvperu/bitel/tvperu_ori_480p/chunks.m3u8', 'TV PERU',this)">
        <img src="/img/TV PERU.png" alt="TV PERU">
      </div>
    </section>
  </main>

  <script>
  const videoPlayer = document.getElementById("videoPlayer");
  const nombreCanal = document.getElementById("nombre-canal");

  function cargarCanal(url, nombre, element) {
  // Activar HLS
  if (Hls.isSupported()) {
    if (videoPlayer.hls) {
      videoPlayer.hls.destroy();
    }
    const hls = new Hls();
    hls.loadSource(url);
    hls.attachMedia(videoPlayer);
    videoPlayer.hls = hls;
  } else if (videoPlayer.canPlayType("application/vnd.apple.mpegurl")) {
    videoPlayer.src = url;
  }

  nombreCanal.textContent = nombre;
  videoPlayer.play();

  // Añadir clase activa visual
  document.querySelectorAll('.card').forEach(card => card.classList.remove('activo'));
  element.classList.add('activo');
}


  function fullscreen() {
    if (videoPlayer.requestFullscreen) {
      videoPlayer.requestFullscreen();
    } else if (videoPlayer.webkitRequestFullscreen) {
      videoPlayer.webkitRequestFullscreen();
    } else if (videoPlayer.msRequestFullscreen) {
      videoPlayer.msRequestFullscreen();
    }
  }

  function activarPiP() {
    if (document.pictureInPictureEnabled && !videoPlayer.disablePictureInPicture) {
      videoPlayer.requestPictureInPicture().catch(console.error);
    }
  }

  // Mostrar hora
  const horaOverlay = document.getElementById("hora-overlay");
  setInterval(() => {
    const ahora = new Date();
    const horas = ahora.getHours().toString().padStart(2, '0');
    const minutos = ahora.getMinutes().toString().padStart(2, '0');
    horaOverlay.textContent = `${horas}:${minutos}`;
  }, 1000);
</script>

<!-- Asegúrate de incluir HLS.js desde CDN -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>


  <footer>
    <p>&copy; 2025 TV Digital en Vivo</p>
  </footer>

  <script src="script.js"></script>
</body>
</html>
