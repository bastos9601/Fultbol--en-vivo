<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TV Digital en Vivo</title>
  <link rel="stylesheet" href="stile.css" />
  <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/833/833472.png" />
</head>

<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('service-worker.js')
        .then(reg => console.log('‚úÖ Service Worker registrado'))
        .catch(err => console.error('‚ùå Error al registrar el Service Worker:', err));
    });
  }

  // Mostrar prompt de instalaci√≥n
  let deferredPrompt;
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;

    const installButton = document.createElement('button');
    installButton.textContent = 'üì≤ Instalar App';
    installButton.style.position = 'fixed';
    installButton.style.bottom = '20px';
    installButton.style.right = '20px';
    installButton.style.padding = '10px 20px';
    installButton.style.zIndex = '1000';
    installButton.style.background = '#000';
    installButton.style.color = '#fff';
    installButton.style.border = 'none';
    installButton.style.borderRadius = '5px';
    installButton.style.cursor = 'pointer';
    document.body.appendChild(installButton);

    installButton.addEventListener('click', async () => {
      installButton.remove();
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      if (outcome === 'accepted') {
        console.log('‚úÖ Usuario acept√≥ instalar');
      } else {
        console.log('‚ùå Usuario rechaz√≥ la instalaci√≥n');
      }
      deferredPrompt = null;
    });
  });
</script>

<body>
  <header>
    <h1>TV Digital en Vivo</h1>
    <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

  </header>

  <main>
    <!-- Reproductor de video -->
    <section class="player-section">
      <h2 id="nombre-canal">Selecciona un canal</h2>
      <div class="video-container">
        <div class="overlay">
          <div class="logo-overlay" aria-label="Logo TV Digital en Vivo" role="img">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" fill="white" width="50" height="50">
              <path d="M592 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h224v32H160c-8.8 0-16 7.2-16 16s7.2 16 16 16h320c8.8 0 16-7.2 16-16s-7.2-16-16-16H368v-32h224c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zM192 304V96l192 104-192 104z"/>
            </svg>
          </div>
          <div id="hora-overlay" class="hora-overlay"></div>
        </div>
        <video id="videoPlayer" controls autoplay playsinline></video>
      </div>
      <div class="controls">
        <button onclick="fullscreen()">Pantalla Completa</button>
        <button onclick="activarPiP()">Ventana Flotante</button>
      </div>
    </section>

    <!-- Tarjetas de canales -->
    <section class="canales-grid">
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/utv/chunks.m3u8', 'UTV')">
        <img src="/img/utv.png" alt="UTV" />
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/americatv/bitel/americatv_ori_480p/chunks.m3u8', 'AM√âRICA TV')">
        <img src="/img/america.png" alt="AMERICA" />
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/panamericana/bitel/panamericana_ori_480p/chunks.m3u8', 'PANAMERICANA TV')">
        <img src="/img/PANAMERICANA.png" alt="PANAMERICANA" />
        </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/latina/bitel/latina_ori_480p/chunks.m3u8', 'LATINA')">
        <img src="/img/LATINA.png" alt="LATINA" />
        </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/atv/bitel/atv_ori_480p/chunks.m3u8', 'ATV')">
        <img src="/img/ATV.png" alt="ATV" />
        </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/fmhmovies/chunks.m3u8', 'FMH MOVIES')">
        <img src="/img/FMH MOVIES.png" alt="FMH MOVIES">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/fmhkids/chunks.m3u8', 'FMH KIDS')">
        <img src="/img/FMH KIDS.png" alt="FMH KIDS">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/bnb/chunks.m3u8', 'BNB')">
        <img src="/img/BNB.png" alt="BNB">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/ribere%C3%B1a/chunks.m3u8', 'RIBERE√ëA')">
        <img src="/img/RIBERE√ëA.jpg" alt="RIBERE√ëA">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/ucayalitv/chunks.m3u8', 'UCAYALI TV')">
        <img src="/img/UCAYALI TV.jpg" alt="UCAYALI TV">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/creolatino/chunks.m3u8', 'CREO LATINO')">
        <img src="/img/CREO LATINO.png" alt="CREO LATINO TU CINE">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/creokids/chunks.m3u8', 'CREO LATINO KIDS')">
        <img src="/img/CREO KIDS.png" alt="CREO KIDS">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/global/bitel/global_ori_480p/chunks.m3u8', 'GLOBAL TV')">
        <img src="/img/GLOBAL.png" alt="GLOBAL TV">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/animeOnegai/bitel/animeOnegai_ori_360p/chunks.m3u8', 'ANIME ONEGAI')">
        <img src="/img/ANIME ONEGAI.png" alt="ANIME ONEGAI">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/nativa/bitel/nativa_ori_480p/chunks.m3u8', 'NATIVA')">
        <img src="/img/NATIVA.png" alt="NATIVA">
      </div>
      <div class="card" onclick="cargarCanal('https://live-evg25.tv360.bitel.com.pe/bitel/tvperu/bitel/tvperu_ori_480p/chunks.m3u8', 'TV PERU')">
        <img src="/img/TV PERU.png" alt="TV PERU">
      </div>
    </section>
  </main>

  <script>
  const videoPlayer = document.getElementById("videoPlayer");
  const nombreCanal = document.getElementById("nombre-canal");

  function cargarCanal(url, nombre) {
    if (Hls.isSupported()) {
      if (videoPlayer.hls) {
        videoPlayer.hls.destroy(); // elimina cualquier instancia previa
      }
      const hls = new Hls();
      hls.loadSource(url);
      hls.attachMedia(videoPlayer);
      videoPlayer.hls = hls;
    } else if (videoPlayer.canPlayType("application/vnd.apple.mpegurl")) {
      videoPlayer.src = url;
    }

    nombreCanal.textContent = nombre;
    videoPlayer.play(); // fuerza reproducci√≥n
  }

  function fullscreen() {
    if (videoPlayer.requestFullscreen) {
      videoPlayer.requestFullscreen();
    } else if (videoPlayer.webkitRequestFullscreen) {
      videoPlayer.webkitRequestFullscreen();
    } else if (videoPlayer.msRequestFullscreen) {
      videoPlayer.msRequestFullscreen();
    }
  }

  function activarPiP() {
    if (document.pictureInPictureEnabled && !videoPlayer.disablePictureInPicture) {
      videoPlayer.requestPictureInPicture().catch(console.error);
    }
  }

  // Mostrar hora
  const horaOverlay = document.getElementById("hora-overlay");
  setInterval(() => {
    const ahora = new Date();
    const horas = ahora.getHours().toString().padStart(2, '0');
    const minutos = ahora.getMinutes().toString().padStart(2, '0');
    horaOverlay.textContent = `${horas}:${minutos}`;
  }, 1000);
</script>

<!-- Aseg√∫rate de incluir HLS.js desde CDN -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>


  <footer>
    <p>&copy; 2024 TV Digital en Vivo</p>
  </footer>

  <script src="script.js"></script>
</body>
</html>
